# elpis_manager

> 「elpis（エルピス）」は、通常、ギリシャ神話や哲学に関連して使われる言葉です。ギリシャ神話では、「エルピス」は希望や期待を意味する女神であり、最も有名なのはパンドラの箱に関するエピソードです。神々がパンドラに贈った箱には、あらゆる災厄が封じ込められていましたが、パンドラが箱を開けたことで、すべての災厄が解き放たれてしまいました。しかし、最後に「エルピス（希望）」だけが箱の中に残ったと言われています。この神話は、逆境や災厄の中にあっても希望を持つことが人間の支えになるという象徴的な教訓として捉えられています。

> また、近年は「elpis」という名前の技術製品や組織名などとしても見かけることがあり、その場合には背景のコンセプトとして「希望」や「未来への期待」といった意味が込められていることが多いです。

企業では、プロジェクト名にギリシャ神話から名前を付けることがあります。本プロジェクトでもその慣例に従い、正式名称ではありませんが、屋内位置推定における「希望」を象徴するものとして、暫定的に「elpis」と名付けています。

## 必要条件

- Go 1.22以上
- Python 3.10以上
  - uv
- Node.js 22以上
- Docker / Docker Compose

## インストール

1. リポジトリをクローンします。

    ```sh
    git clone git@github.com:kajiLabTeam/elpis_manager.git
    cd elpis_manager
    ```

2. 必要な依存関係をインストールします。

    ```sh
    cd ./manager && go mod download
    cd ./echo && go mod download
    ```

## 使い方

### サーバーの起動方法

#### 方法1: Docker Composeで立ち上げる

Docker Composeを使用して、すべてのサービスをバックグラウンドで起動します。

```sh
make up
```

サービスの状態を確認するには:

```sh
docker compose ps
```

すべてのサービスを停止するには:

```sh
make down
```

#### 方法2: ローカル環境で立ち上げる

ローカル環境で各サービスを個別に起動します。

1. **データベースの起動**

    データベースサービスのみを起動します。

    ```sh
    make db-up
    ```

2. **プロキシサービスの起動**

    別のターミナルで、プロキシサービスをローカルで起動します。

    ```sh
    make proxy-local
    ```

3. **マネージャーサービスの起動**

    別のターミナルで、マネージャーサービスをローカルで起動します。

    ```sh
    make manager-local
    ```

4. **推定サービスの起動**

    別のターミナルで、推定サービス（Estimation API）をローカルで起動します。

    ```sh
    make est-api-local
    ```

5. **サービスの停止**

    関連するボリュームを削除します。

    ```sh
    make db-down
    ```

### エンドツーエンドテストの実行

プロジェクトには、各サービスのエンドツーエンドテスト用のシェルスクリプトが用意されています。以下のMakeコマンドを使用してテストを実行できます。

- **すべてのエンドツーエンドテストを実行**

    ```sh
    make e2e-test
    ```

- **個別のテストを実行**

    - **推定APIのテスト**

        ```sh
        make est-api-test
        ```

    - **マネージャーサービスのテスト**

        ```sh
        make manager-test
        ```

    - **プロキシサービスのテスト**

        ```sh
        make proxy-test
        ```

    - **ウェブサービスのテスト**

        ```sh
        make web-test
        ```

### その他のコマンド

- **サービスの再起動**

    全サービスを再起動するには:

    ```sh
    make restart
    ```

- **特定のサービスを再起動**

    マネージャーサービスのみを再起動:

    ```sh
    make restart-manager
    ```

    プロキシサービスのみを再起動:

    ```sh
    make restart-proxy
    ```

## Python(uv)

推定サーバにはPythonを使った機械学習モデルを採用しています。下記リンクからuvを導入してください。

[uvの導入ガイド](https://zenn.dev/turing_motors/articles/594fbef42a36ee)

- **推定サービスのローカル起動**

    ```sh
    make est-api-local
    ```

## ヘルプの表示

利用可能なすべてのMakeコマンドを確認するには:

```sh
make help
```

## ライセンス

現状のElpisプロジェクトは、GPLv3ライセンスの下で公開されています。
ライセンスの詳細については、[LICENSE](LICENSE)ファイルを参照してください。
